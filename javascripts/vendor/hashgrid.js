/**
 * @license Copyright 2013 Analog Coop Limited
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"undefined"==typeof jQuery&&alert("Hashgrid: jQuery not loaded. Make sure it's linked to your pages.");var hashgrid=function(e){function i(e){if(null===z.modifierKey)return!0;var i=!0;switch(z.modifierKey){case"ctrl":i=e.ctrlKey?e.ctrlKey:!1;break;case"alt":i=e.altKey?e.altKey:!1;break;case"shift":i=e.shiftKey?e.shiftKey:!1}return i}function r(e){var i=!1,r=e.keyCode?e.keyCode:e.which;return i=13==r?"enter":String.fromCharCode(r).toLowerCase()}function t(){d(z.cookiePrefix+z.id,(L?"1":"0")+"-"+F+"-"+P,1)}function s(){g.show(),m.css({width:g.width()}),m.children(".vert").each(function(){var e=G(this);e.css("display","inline-block"),e.offset().top>e.parent().offset().top&&e.hide()})}function n(e){var n,o,d=e.target.tagName.toLowerCase();if("input"==d||"textarea"==d||"select"==d)return!0;if(o=i(e),!o)return!0;if(n=r(e),!n)return!0;if(l[n])return!0;switch(l[n]=!0,n){case z.showGridKey:j?L&&(g.hide(),j=!1,L=!1,t()):(s(),j=!0);break;case z.holdGridKey:j&&!L&&(L=!0,t());break;case z.foregroundKey:j&&(g.css("z-index")==O?(g.css("z-index",N),F="B"):(g.css("z-index",O),F="F"),t());break;case z.jumpGridsKey:j&&z.numberOfGrids>1&&(g.removeClass(z.classPrefix+P),P++,P>z.numberOfGrids&&(P=1),g.addClass(z.classPrefix+P),s(),/webkit/.test(navigator.userAgent.toLowerCase())&&c(),t())}return!0}function o(e){var t,s=i(e);return s?(t=r(e),l[t]=!1,t&&t==z.showGridKey&&!L&&(g.hide(),j=!1),!0):!0}function d(e,i,r){var t,s="";r&&(t=new Date,t.setTime(t.getTime()+24*r*60*60*1e3),s="; expires="+t.toGMTString()),document.cookie=e+"="+i+s+"; path=/"}function a(e){for(var i,r=document.cookie.split(";"),t=0,s=r.length,n=e+"=";s>t;t++){for(i=r[t];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return i.substring(n.length,i.length)}return null}function c(){var e=document.styleSheets[0];try{e.addRule(".xxxxxx","position: relative"),e.removeRule(e.rules.length-1)}catch(i){}}var l,f,u,h,p,y,v,g,x,b,m,k,K,w,C,G=jQuery,z={id:"grid",modifierKey:null,showGridKey:"g",holdGridKey:"h",foregroundKey:"f",jumpGridsKey:"j",numberOfGrids:1,classPrefix:"grid-",cookiePrefix:"hashgrid"},P=1,j=!1,F="B",N=-1,O=9999,L=!1;if("object"==typeof e)for(K in e)z[K]=e[K];else"string"==typeof e&&(z.id=e);if(G("#"+z.id).length>0&&G("#"+z.id).remove(),b=G("<div></div>"),b.attr("id",z.id).css({display:"none",pointerEvents:"none"}),G("body").prepend(b),g=G("#"+z.id),"auto"==g.css("z-index")&&g.css("z-index",N),k=parseFloat(G(document).height()),g.height(k),g.append('<div id="'+z.id+'-horiz" class="horiz first-line">'),C=g.css("top"),g.css({top:"-999px",display:"block"}),p=G("#"+z.id+"-horiz"),y=p.outerHeight(),g.css({display:"none",top:C}),0>=y)return!1;for(v=Math.floor(k/y),f="",h=v-1;h>=1;h--)f+='<div class="horiz"></div>';for(g.append(f),g.append(G('<div class="vert-container"></div>')),m=g.children(".vert-container"),u=g.width(),m.css({width:u,position:"absolute",top:0}),m.append('<div class="vert first-line">&nbsp;</div>'),f="",h=0;30>h;h++)f+='<div class="vert">&nbsp;</div>';return m.append(f),m.children().height(k).css({display:"inline-block"}),x=a(z.cookiePrefix+z.id),"string"==typeof x?(w=x.split("-"),w[2]=Number(w[2]),"number"!=typeof w[2]||isNaN(w[2])||(P=w[2].toFixed(0),g.addClass(z.classPrefix+P)),"F"==w[1]&&(F="F",g.css("z-index",O)),"1"==w[0]&&(j=!0,L=!0,s())):g.addClass(z.classPrefix+P),G(document).bind("keydown",n),G(document).bind("keyup",o),l={},{}};